"""Test the models by comparing them with values on reference data from previous
runs. This is a change detection test to ensure nothing is broken when making
changes to the code."""

import os
import redback
import unittest

from test_utils.ref_data_utils import test_on_ref_data

_dirname = os.path.dirname(__file__)


class TestOnReferenceData(unittest.TestCase):

    def test_tophat_redback_ref_data(self):
        """Test the tophat_redback model against reference data.
        
        If this test fails the reference data can be regenerated by running
        the make_afterglow_ref_data.py script in the test_utils directory.
        """
        self.reference_file = os.path.join(_dirname, "reference_results", "tophat_redback_ref_data.ecsv")
        test_on_ref_data(
            redback.transient_models.afterglow_models.tophat_redback,
            self.reference_file,
        )
